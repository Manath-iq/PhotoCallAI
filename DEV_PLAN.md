# Development Plan: Telegram Mini App Nutrition Assistant

## Введение
Telegram Mini App Nutrition Assistant — это AI-помощник по питанию, который помогает пользователю достигать целей (похудение, поддержание формы, набор массы) с помощью анализа рациона и рекомендаций. Все данные хранятся только на устройстве пользователя для приватности. Анализ и рекомендации — через бесплатную AI-модель OpenRouter, backend на Cloudflare Worker.

---

## Архитектура
- **Frontend:** React (Telegram Mini App SDK), хранение данных в localStorage/IndexedDB.
- **Backend:** Cloudflare Worker (API-прокси для AI, не хранит пользовательские данные).
- **AI:** Бесплатная модель OpenRouter (Llama/Mistral/MythoMax и др.).
- **Фото:** Сжимаются на клиенте, отправляются на backend только для анализа.
- **Интеграция:** Telegram Mini App API для авторизации и UI.

---

## Основные фичи (MVP)
1. **Анкета пользователя**
   - Форма сбора физ. данных (пол, возраст, рост, вес, цель)
   - Валидация и сохранение в localStorage
   - Показывается только при первом запуске
2. **Дневник питания**
   - CRUD для приёмов пищи (добавление, редактирование, удаление)
   - Фото/ручной ввод еды
   - Фото анализируется AI, результат сохраняется локально
3. **Итоги дня**
   - Кнопка для отправки дневника за день на AI-анализ
   - Получение отчёта и рекомендаций
   - После отчёта данные за день удаляются из памяти устройства
4. **Приватность**
   - Нет серверных БД, все данные только на устройстве
   - Фото и данные отправляются на сервер только для анализа, не хранятся
5. **UI/UX**
   - Минималистичный интерфейс, адаптированный под Telegram Mini App
   - Ясные предупреждения о приватности и удалении данных
   - Быстрый доступ к добавлению еды и итогам дня

---

## Дорожная карта разработки (Roadmap)
### MVP
- [x] Анкета пользователя (форма, валидация, сохранение)
- [x] Главная страница с дневником питания (CRUD, фото, AI-анализ)
  - [x] Отображение пустого состояния
  - [x] Добавление приема пищи с фото
  - [x] Отображение списка приемов пищи
  - [x] Удаление приема пищи
  - [ ] AI-анализ фото еды
- [ ] Кнопка "Итоги дня" (отправка дневника, получение отчёта, удаление)
- [x] Минималистичный UI для Telegram Mini App
- [ ] Интеграция с Cloudflare Worker и OpenRouter API
- [ ] Приватность: предупреждения, отсутствие серверного хранения
- [x] Обновление дизайна с использованием Tailwind CSS и Ant Design
  - [x] Установка и настройка Tailwind CSS
  - [x] Установка и настройка Ant Design
  - [x] Создание общих компонентов
  - [x] Обновление существующих компонентов с новым дизайном
  - [ ] Завершение редизайна всего приложения

### Будущие улучшения
- [ ] Геймификация (ачивки, streaks)
- [ ] Push-уведомления
- [ ] Расширенная аналитика
- [ ] Социальные функции (друзья, челленджи)

---

## Логика зависимостей (Dependency Chain)
1. Анкета и хранение профиля
2. Дневник питания и добавление еды
3. Интеграция AI-анализа еды
4. "Итоги дня" и удаление данных
5. UI/UX polishing, интеграция с Telegram API

---

## Риски и способы их минимизации
- **AI-анализ фото может ошибаться:** Возможность ручного редактирования результата
- **Ограничения localStorage:** Сжимать фото, хранить только за 1 день, удалять после отчёта
- **Потеря данных при удалении приложения:** Ясное предупреждение пользователю
- **Ограничения бесплатных AI-моделей:** Возможность смены модели или fallback на ручной ввод

---

## Appendix
- Исследование Telegram Mini App SDK
- Сравнение бесплатных AI-моделей на OpenRouter
- Примеры UI для Telegram Mini App

---

## Task Breakdown & TODO-лист

### 1. Анкета пользователя
- [x] Спроектировать структуру данных профиля пользователя
  - _Готово, если: структура описана, поля определены_
- [x] Реализовать компонент формы анкеты (React)
  - _Готово, если: форма отображается, все поля присутствуют_
- [x] Добавить валидацию полей анкеты
  - _Готово, если: некорректные значения не проходят_
- [x] Сохранять данные анкеты в localStorage
  - _Готово, если: данные сохраняются и подгружаются при повторном запуске_
- [x] Реализовать логику показа анкеты только при первом запуске
  - _Готово, если: анкета не появляется повторно для заполненного профиля_

### 2. Дневник питания
- [x] Спроектировать структуру данных дневника питания
  - _Готово, если: структура описана, поддерживает фото и текст_
- [x] Реализовать компонент списка приёмов пищи
  - _Готово, если: список отображает все приёмы за день_
- [x] Реализовать добавление приёма пищи (форма + фото)
  - _Готово, если: можно добавить запись с фото или текстом_
- [x] Реализовать редактирование и удаление приёма пищи
  - _Готово, если: можно изменить или удалить запись_
- [x] Сохранять дневник питания в localStorage
  - _Готово, если: данные не теряются при перезагрузке_

### 3. AI-анализ еды
- [x] Реализовать сжатие фото на клиенте перед отправкой
  - _Готово, если: фото уменьшается до заданного размера_
- [ ] Реализовать отправку фото и описания на Cloudflare Worker
  - _Готово, если: запрос уходит, ответ приходит_
- [ ] Интегрировать OpenRouter API для анализа БЖУ
  - _Готово, если: получаем результат анализа от AI_
- [ ] Сохранять результат анализа в дневнике питания
  - _Готово, если: результат отображается рядом с записью_
- [ ] Добавить возможность ручного редактирования результата анализа
  - _Готово, если: пользователь может исправить БЖУ/калории_

### 4. Итоги дня
- [ ] Реализовать кнопку "Итоги дня"
  - _Готово, если: кнопка видна и активна при наличии записей_
- [ ] Собрать все данные за день и отправить на AI-анализ
  - _Готово, если: отправляется весь дневник за день_
- [ ] Получить и отобразить отчёт и рекомендации от AI
  - _Готово, если: отчёт виден пользователю_
- [ ] Удалять дневник за день после получения отчёта
  - _Готово, если: данные очищаются, новый день начинается с пустого дневника_

### 5. UI/UX и интеграция с Telegram
- [x] Интегрировать Telegram Mini App SDK
  - _Готово, если: приложение запускается в Telegram, работает авторизация_
- [x] Реализовать минималистичный дизайн, адаптированный под Telegram
  - _Готово, если: интерфейс удобен, соответствует гайдлайнам Telegram_
- [x] Обновить дизайн с использованием Tailwind CSS и Ant Design
  - _Готово, если: интерфейс использует зеленую цветовую схему и современные компоненты_
- [ ] Добавить предупреждения о приватности и удалении данных
  - _Готово, если: пользователь информирован о политике хранения данных_
- [ ] Провести тестирование UX на реальных пользователях
  - _Готово, если: получена обратная связь, внесены улучшения_

---

### Критерии готовности проекта (Definition of Done)
- Все MVP-фичи реализованы и протестированы
- Нет критических багов, UX удобен
- Приватность данных соблюдена
- Приложение стабильно работает в Telegram Mini App 